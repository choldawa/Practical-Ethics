json.data[["trials"]][["prompt"]],
json.data[["trials"]][["chosenData"]][["g1"]],
json.data[["trials"]][["chosenData"]][["g2"]],
json.data[["trials"]][["chosenData"]][["g3"]],
json.data[["trials"]][["chosenData"]][["g4"]],
json.data[["trials"]][["chosenData"]][["mu"]],
json.data[["trials"]][["chosenData"]][["tradeoff"]],
json.data[["trials"]][["chosenData"]][["p"]],
json.data[["trials"]][["jitter"]],
json.data[["subjectData"]][["promptCheck1"]],
json.data[["subjectData"]][["promptCheck2"]])
df_full$id = json.data[["client"]][["sid"]]
}
# if the merged dataset does exist, append to it
if (exists("df_full")){
json.data = fromJSON(file)
temp_dataset = data.frame(json.data[["trials"]][["response"]],
json.data[["trials"]][["att"]],
json.data[["trials"]][["trialNumber"]],
json.data[["trials"]][["prompt"]],
json.data[["trials"]][["chosenData"]][["g1"]],
json.data[["trials"]][["chosenData"]][["g2"]],
json.data[["trials"]][["chosenData"]][["g3"]],
json.data[["trials"]][["chosenData"]][["g4"]],
json.data[["trials"]][["chosenData"]][["mu"]],
json.data[["trials"]][["chosenData"]][["tradeoff"]],
json.data[["trials"]][["chosenData"]][["p"]],
json.data[["trials"]][["jitter"]],
json.data[["subjectData"]][["promptCheck1"]],
json.data[["subjectData"]][["promptCheck2"]])
temp_dataset$id = json.data[["client"]][["sid"]]
df_full = rbind(df_full, temp_dataset)
rm(temp_dataset)
}
}
setwd("././data")
#Read in and merge all json data files
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
setwd("././data")
setwd("../data")
file_list = list.files()
# setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# setwd("./dataV3V4combined")
# file_list = list.files()
for (file in file_list){
print(file)
# if the merged dataset doesn't exist, create it
if (!exists("df_full")){
json.data = fromJSON(file)
df_full = data.frame(json.data[["trials"]][["response"]],
json.data[["trials"]][["att"]],
json.data[["trials"]][["trialNumber"]],
json.data[["trials"]][["prompt"]],
json.data[["trials"]][["chosenData"]][["g1"]],
json.data[["trials"]][["chosenData"]][["g2"]],
json.data[["trials"]][["chosenData"]][["g3"]],
json.data[["trials"]][["chosenData"]][["g4"]],
json.data[["trials"]][["chosenData"]][["mu"]],
json.data[["trials"]][["chosenData"]][["tradeoff"]],
json.data[["trials"]][["chosenData"]][["p"]],
json.data[["trials"]][["jitter"]],
json.data[["subjectData"]][["promptCheck1"]],
json.data[["subjectData"]][["promptCheck2"]])
df_full$id = json.data[["client"]][["sid"]]
}
# if the merged dataset does exist, append to it
if (exists("df_full")){
json.data = fromJSON(file)
temp_dataset = data.frame(json.data[["trials"]][["response"]],
json.data[["trials"]][["att"]],
json.data[["trials"]][["trialNumber"]],
json.data[["trials"]][["prompt"]],
json.data[["trials"]][["chosenData"]][["g1"]],
json.data[["trials"]][["chosenData"]][["g2"]],
json.data[["trials"]][["chosenData"]][["g3"]],
json.data[["trials"]][["chosenData"]][["g4"]],
json.data[["trials"]][["chosenData"]][["mu"]],
json.data[["trials"]][["chosenData"]][["tradeoff"]],
json.data[["trials"]][["chosenData"]][["p"]],
json.data[["trials"]][["jitter"]],
json.data[["subjectData"]][["promptCheck1"]],
json.data[["subjectData"]][["promptCheck2"]])
temp_dataset$id = json.data[["client"]][["sid"]]
df_full = rbind(df_full, temp_dataset)
rm(temp_dataset)
}
}
df = df_full %>% distinct()
colnames(df) = c("response","att", "trialNumber", "prompt", "g1","g2","g3","g4", "mu", "tradeoff", "p", "jitter","check1", "check2", "id")
df$response = as.numeric(as.character(df$response))
#variance of response
df = df %>%
mutate(var = pmap_dbl(list(g1,g2,g3,g4), ~ var(c(...))))
df$sd = sqrt(df$var)
#attention checks
df30 = df %>% select(att, p, id, trialNumber) %>%  filter(att == 1, trialNumber ==5)
df$g1 = round(df$g1,0)
df$g2 = round(df$g2,0)
df$g3 = round(df$g3,0)
df$g4 = round(df$g4,0)
df$mu = round(df$mu,0)
#variance of response
df = df %>%
mutate(var = pmap_dbl(list(g1,g2,g3,g4), ~ var(c(...))))
df$sd = sqrt(df$var)
min(df$sd)
max(df$sd)
#dataframe manipulation (can be done on group df)
df$prompt.type <- ifelse(grepl("loan", df$prompt, ignore.case = T), "loan",
ifelse(grepl("newspaper", df$prompt, ignore.case = T), "newspaper",
ifelse(grepl("bail", df$prompt, ignore.case = T), "bail",
ifelse(grepl("job", df$prompt, ignore.case = T), "job",
ifelse(grepl("meals", df$prompt, ignore.case = T), "meals",
ifelse(grepl("respirator", df$prompt, ignore.case = T), "respirator","Other"))))))
df$tradeoff <- ifelse(grepl("LOW", df$tradeoff, ignore.case = T), "low",
ifelse(grepl("MED", df$tradeoff, ignore.case = T), "med","high"))
df = df %>% mutate(tradeoff = fct_relevel(tradeoff,
"low",
"med",
"high"))
df = df %>%
filter(att == 0)
glimpse(df)
df_high = df %>% filter(tradeoff == "high")
df_low = df %>% filter(tradeoff == "low")
df_med = df %>% filter(tradeoff == "med")
df_high = df %>% filter(tradeoff == "high")
df_low %>% select(mu == max(mu) || sd ==0)
glimpse(df_low)
df_low %>% filter(mu == max(mu) || sd ==0)
length(df_low %>% filter(mu == max(mu)))/length(df_low)
sum(df_low %>% filter(mu == max(mu)))/length(df_low)
df_low[df$mu == max(df$mu)]
df_low$mu[df$mu == max(df$mu)]
df_low[df$mu == max(df$mu)]$mu
df$mu == max(df$mu)
df_low$mu == max(df_low$mu)
sum((df_low$mu == max(df_low$mu)))/length(df_low)
length(df$low)
length(df_low)
length(df_low$mu)
sum((df_low$mu == max(df_low$mu)))/length(df_low$mu)
sum(df_low$sd == 0)/length(df_low$sd)
table(df$mu)
table(df_low$mu)
max(df_low$mu)
sum((df_med$mu == max(df_med$mu)))/length(df_med$mu)
sum(df_med$sd == 0)/length(df_med$sd)
sum((df_high$mu == max(df_high$mu)))/length(df_high$mu)
sum(df_high$sd == 0)/length(df_high$sd)
df_high %>% filter(df_high$mu ==max(df_high$mu))
sum(df_high$sd == 0)
sum((df_high$mu == max(df_high$mu)))
df_high %>% filter(df_high$mu != max(df_high$mu) && df_high$sd != 0)
df_high %>%
filter(df_high$mu != max(df_high$mu) && df_high$sd != 0) %>%
ggplot(aes(x = p))+geom_histogram()
df_high %>%
# filter(df_high$mu != max(df_high$mu) && df_high$sd != 0) %>%
ggplot(aes(x = p))+geom_histogram()
df_high %>%
filter(df_high$mu != max(df_high$mu) && df_high$sd != 0)
df_high %>%
filter(df_high$mu != max(df_high$mu) & df_high$sd != 0) %>%
ggplot(aes(x = p))+geom_histogram()
df_high %>%
filter(df_high$mu != max(df_high$mu) & df_high$sd != 0)
sum((df_high$mu == max(df_high$mu)))/length(df_high$mu)
sum(df_high$sd == 0)/length(df_high$sd)
sum((df_high$mu == max(df_high$mu)))
sum(df_high$sd == 0)/length(df_high$sd)
sum(df_high$sd == 0)
df_high %>%
filter(df_high$mu != max(df_high$mu) & df_high$sd != 0)
sum(df_high$sd == 0)
sum((df_high$mu == max(df_high$mu)))
df_high %>%
filter(df_high$mu != max(df_high$mu) & df_high$sd != 0) %>%
select(min(p))
df_high %>%
filter(df_high$mu != max(df_high$mu) & df_high$sd != 0) %>%
select(min(df_high$p))
df_high %>%
filter(df_high$mu != max(df_high$mu) & df_high$sd != 0) %>%
select(min(df_high$p))
df_high %>%
filter(df_high$mu != max(df_high$mu) & df_high$sd != 0)
df_high %>%
filter(df_high$mu != max(df_high$mu) & df_high$sd != 0) %>% table(p)
df_high %>%
filter(mu != max(mu) & sd != 0) %>% table(p)
glimpse(df_high %>%
filter(mu != max(mu) & sd != 0))
df_high %>%
filter(mu != max(mu) & sd != 0) %>% filter(p == min(p))
df_high %>%
filter(mu != max(mu) & sd != 0) %>% filter(p == 100)
df_high %>%
filter(mu != max(mu) & sd != 0) %>% filter(p == 99)
df_high %>%
filter(mu != max(mu) & sd != 0) %>% filter(p >100)
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = p))+geom_histogram(bins = 50)
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = p))+geom_histogram(bins = 100)
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = p))+geom_density()
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = p))+geom_histogram(bins = 70)
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = p))+geom_histogram(bins = 60)
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = p))+geom_histogram(bins = 65)
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = p))+geom_histogram(bins = 70)
mean((df_high %>%
filter(mu != max(mu) & sd != 0))$p)
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd)) + geom_bin2d()
df_high %>%
#filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd)) + geom_bin2d()
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd)) + geom_bin2d() +theme_bw()
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd)) + geom_bin2d() +theme_minimal()
df_high %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=18))
df_high %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=18))
df_high %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal(bins = 20)+
theme(text = element_text(size=18))
df_high %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=18))
df_low %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=18))
df_high %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=18))
df_low %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=18))
df_med %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=18))
df_med %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=18))
df_med %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
geom_smooth()+
theme(text = element_text(size=18))
df_med %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=18))
df_med %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=28))
df_high %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=28))
df_low %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) +
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=28))
df_low %>%
filter(mu != max(mu) & sd != 0 & p<100)
df_low %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd)) + geom_point()
df_low %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd))
df_low %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=28))
df_low %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=28))
df_low %>%
filter(mu != max(mu) & sd != 0 & mu == 59) %>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=28))
df_low %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=28))
lm(df_high, sd~mu, method = "linear")
lm(df_high, sd~mu)
lm(data = df_high, sd~mu)
lm(data = df_med, sd~mu)
sum((df_low$mu == max(df_low$mu)))/length(df_low$mu)
sum(df_low$sd == 0)/length(df_low$sd)
sum((df_med$mu == max(df_med$mu)))/length(df_med$mu)
sum(df_med$sd == 0)/length(df_med$sd)
sum((df_high$mu == max(df_high$mu)))/length(df_high$mu)
sum(df_high$sd == 0)/length(df_high$sd)
df_low %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
theme(text = element_text(size=28))
df_low %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
ylim(0,35)+
theme(text = element_text(size=28))
df_med %>%
filter(mu != max(mu) & sd != 0) %>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
ylim(0,35)+
theme(text = element_text(size=28))
df_med %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
ylim(0,35)+
theme(text = element_text(size=28))
df_high %>%
filter(mu != max(mu) & sd != 0 & p<100) %>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
ylim(0,35)+
theme(text = element_text(size=28))
df_high %>%
filter(mu != max(mu) & sd != 0 & p<100) %>% min(p)
min((df_high %>%
filter(mu != max(mu) & sd != 0 & p<100))$p)
max((df_high %>%
filter(mu != max(mu) & sd != 0 & p<100))$p)
mean((df_high %>%
filter(mu != max(mu) & sd != 0 & p<100))$p)
mean((df_high %>%
filter(mu != max(mu) & sd != 0 & p<100))$mu)
mean((df_med  %>%
filter(mu != max(mu) & sd != 0 & p<100))$mu)
mean((df_low  %>%
filter(mu != max(mu) & sd != 0 & p<100))$mu)
df_low  %>%
filter(mu != max(mu) & sd != 0 & p<100)%>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
ylim(0,35)+
theme(text = element_text(size=28))
df_med  %>%
filter(mu != max(mu) & sd != 0 & p<100)%>%
ggplot(aes(x = mu, y = sd))+
geom_bin2d() +
theme_minimal()+
ylim(0,35)+
theme(text = element_text(size=28))
[1:10]
df_musd = x <- data.frame("mu" = 1:100)
df_musd = data.frame("mu" = 1:100)
df_musd = data.frame("mu" = 10:100)
df_musd$sd1 = df_musd$mu + 10
ggplot(data = df_musd, aes(x = mu, y = sd1))+geom_line()
ggplot(data = df_musd)+geom_line(aes(x = mu, y = sd1))
ggplot(data = df_musd)+geom_line(aes(x = mu, y = sd1))+geom_line(aes(x = mu, y = sd2x))
ggplot(data = df_musd)+geom_line(aes(x = mu, y = sd1))+geom_line(aes(x = mu, y = sd2))
df_musd$sd2 = df_musd$mu + 20
ggplot(data = df_musd)+geom_line(aes(x = mu, y = sd1))+geom_line(aes(x = mu, y = sd2))
df_musd$sd2 = 0.5*df_musd$mu + 20
ggplot(data = df_musd)+
geom_line(aes(x = mu, y = sd))+
geom_line(aes(x = mu, y = sd1))+
aes(x = mu, y = sd1)
ggplot(data = df_musd)+
geom_line(aes(x = mu, y = sd))+
geom_line(aes(x = mu, y = sd1))+
geom_line(aes(x = mu, y = sd2))
df_musd$sd2 = 0.5*df_musd$mu + 20
ggplot(data = df_musd)+
geom_line(aes(x = mu, y = sd))+
geom_line(aes(x = mu, y = sd1))+
geom_line(aes(x = mu, y = sd2))
df_musd$sd = df_musd$mu + 10
df_musd$sd1 = df_musd$mu + 20
df_musd$sd2 = 0.5*df_musd$mu + 20
ggplot(data = df_musd)+
geom_line(aes(x = mu, y = sd))+
geom_line(aes(x = mu, y = sd1))+
geom_line(aes(x = mu, y = sd2))
df_musd$sd2 = 0.5*df_musd$mu + 10
ggplot(data = df_musd)+
geom_line(aes(x = mu, y = sd))+
geom_line(aes(x = mu, y = sd1))+
geom_line(aes(x = mu, y = sd2))
df_musd$sd2 = 0.5*df_musd$mu + 5
ggplot(data = df_musd)+
geom_line(aes(x = mu, y = sd))+
geom_line(aes(x = mu, y = sd1))+
geom_line(aes(x = mu, y = sd2))
df_musd$sd2 = 0.5*df_musd$mu + 15
ggplot(data = df_musd)+
geom_line(aes(x = mu, y = sd))+
geom_line(aes(x = mu, y = sd1))+
geom_line(aes(x = mu, y = sd2))
df_musd$sd2 = 0.5*df_musd$mu - 5
df_musd$sd = df_musd$mu - 10
df_musd$sd1 = 1.2*df_musd$mu - 12
df_musd$sd2 = 0.5*df_musd$mu - 5
ggplot(data = df_musd)+
geom_line(aes(x = mu, y = sd))+
geom_line(aes(x = mu, y = sd1))+
geom_line(aes(x = mu, y = sd2))
ggplot(data = df_musd)+
geom_line(aes(x = mu, y = sd))+
geom_line(aes(x = mu, y = sd1))+
geom_line(aes(x = mu, y = sd2))+
theme_minimal()+
theme(text = element_text(size=28))
df_musd$sd3 = 0.1*df_musd$mu - 1
ggplot(data = df_musd)+
geom_line(aes(x = mu, y = sd))+
geom_line(aes(x = mu, y = sd1))+
geom_line(aes(x = mu, y = sd2))+
geom_line(aes(x = mu, y = sd3))+
theme_minimal()+
theme(text = element_text(size=28))
mean((df_low  %>%
filter(mu != max(mu) & sd != 0 & p<100))$p)
mean((df_med  %>%
filter(mu != max(mu) & sd != 0 & p<100))$p)
min((df_med  %>%
filter(mu != max(mu) & sd != 0 & p<100))$p)
min((df_med  %>%
filter(mu != max(mu) & sd != 0 & p<100 &p >0))$p)
max((df_med  %>%
filter(mu != max(mu) & sd != 0 & p<100 &p >0))$p)
mean((df_med  %>%
filter(mu != max(mu) & sd != 0 & p<100 &p >0))$p)
min((df_med  %>%
filter(mu != max(mu) & sd != 0 & p<100 &p >0))$p)
min((df_high  %>%
filter(mu != max(mu) & sd != 0 & p<100 &p >0))$p)
mean((df_high  %>%
filter(mu != max(mu) & sd != 0 & p<100 &p >0))$p)
